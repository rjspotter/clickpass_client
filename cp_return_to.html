<!DOCTYPE html>
<html>
  <head>
    <title>...</title>
  </head>
  <body>
    <script type="text/javascript">

      var getVariables = (function (){

        function aggregate (obj,pair) {obj[pair[0]] = pair[1] ; return obj;}

        function pairier (stringPairs, collector) {
          return stringPairs[0] === undefined ? collector :
                 pairier(
                   stringPairs.slice(1,stringPairs.length),
                   aggregate(collector, stringPairs[0].split('='))
                 );
        }
        return pairier(window.location.search.split('&'), {});
      })();

      if (getVariables['openid.mode'] === 'id_res') {
        window.opener.__cp_data = getVariables;
        window.opener.location.hash = 'finished';
        window.close();
      } else {
        window.opener.location.hash = 'cancelled';
        window.close();
      }
    </script>
  </body>
</html>
